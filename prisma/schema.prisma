generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DB_STRING_FOR_PRISMA")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  firstName String
  lastName  String
  dob       DateTime @default(now())
  role      Role     @default(POLICY_HOLDER)
  address   String
  phone     Int
  policies    Policy[]
}

model Policy {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  hospName  String
  hospCity  String
  desc      String
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  claim     Claim?
}

model Claim {
  id               Int        @id @default(autoincrement())
  createdAt        DateTime   @default(now())
  desc             String
  claimType        String
  dateOfIntimation DateTime
  claimAmount      Int
  policy           Policy     @relation(fields: [policyId], references: [id])
  policyId         Int        @unique
  documents        Document[]
  report           Report?
}

model Document {
  id      Int     @id @default(autoincrement())
  docType DocType
  name    String
  url     String
  claim   Claim   @relation(fields: [claimId], references: [id])
  claimId Int
}

model Report {
  id                  Int     @id @default(autoincrement())
  documentWiseSummary Json
  combinedSummary     String
  estimatedExpenses   Json
  notes               String
  approved            Boolean
  claim               Claim   @relation(fields: [claimId], references: [id])
  claimId             Int     @unique
}

model Otp {
  id       Int      @id @default(autoincrement())
  email    String
  code     String
  expireAt DateTime
}

enum Role {
  POLICY_HOLDER
  CLAIM_ASSESSOR
}

enum DocType {
  SCAN
  TEXT
}
